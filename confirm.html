<!DOCTYPE html>
<html>
  <head><title>Confirm Email</title></head>
  <body>
    <h1>Email Confirmation</h1>
    <p id="status">Verifying...</p>
    <script type="module">
      import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
      const supabase = createClient(
        'https://zgjfbbfnldxlvzstnfzy.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpnamZiYmZubGR4bHZ6c3RuZnp5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk2NDczNzIsImV4cCI6MjA2NTIyMzM3Mn0.-Lt8UIAqI5ySoyyTGzRs3JVBhdcZc8zKxiLH6qbu3dU'
      );
      async function confirm() {
        const params = new URLSearchParams(window.location.search);
        const token = params.get('token') || params.get('access_token');
        const type = params.has('type') ? params.get('type') : 'signup';
        const { data, error } = await supabase.auth.verifyOtp({
          token_hash: token,
          type: type,
        });
        document.getElementById('status').innerText = error ? error.message : 'Email Confirmed!';
        if (!error) window.location.href = 'feed.html';
      }
      confirm();
    </script>
  </body>
</html>